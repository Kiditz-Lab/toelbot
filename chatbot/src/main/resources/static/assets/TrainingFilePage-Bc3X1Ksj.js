import{_ as B}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-ZkhCggGJ.js";import{_ as h}from"./UiParentCard.vue_vue_type_script_setup_true_lang-D2f-MrwW.js";import{N as f,P as L,q as w,o as c,a as e,w as a,d as U,_ as P,B as s,K as E,$ as x,ai as O,aj as M,s as T,y as S,O as z,a1 as N,c as V,k as F,ak as j,al as q,D as G,u as K,n as W,am as H,j as J,e as A,t as Q,f as R,an as X,ad as Y,V as $,b as k}from"./index-B-4Jq8Ft.js";import{e as Z,f as ee}from"./mdi-CCnSVLV7.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{D as te}from"./DeleteDialog-DqafGwoF.js";import{u as le}from"./client-KZQCG3Am.js";import{u as m,_ as oe}from"./TrainingSummary.vue_vue_type_script_setup_true_lang-PW8VqNmX.js";import"./useApi-Bby6fr-m.js";import"./snackbarStore-KsQP317g.js";const se={__name:"FileUpload",emits:["upload"],setup(b,{emit:g}){const _=g,u=f([]),l=f(!1),d=f(null);L(u,t=>{_("upload",t)},{deep:!0});const v=()=>{d.value.$el.querySelector("input").click()},D=t=>{if(!t||!t.target||!t.target.files)return;const n=Array.from(t.target.files);u.value=[...n],t.target.value=null},y=t=>{l.value=!0,t.dataTransfer.dropEffect="copy"},r=()=>{l.value=!1},p=t=>{l.value=!1;const n=Array.from(t.dataTransfer.files).filter(i=>["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","text/markdown"].includes(i.type));u.value=[...n]};return(t,n)=>(c(),w(T,null,[e(O,{class:E(["drop-zone",{dragover:l.value}]),onDragover:x(y,["prevent"]),onDragleave:x(r,["prevent"]),onDrop:x(p,["prevent"]),onClick:v},{default:a(()=>[e(P,{size:"40",color:"primary",icon:s(Z)},null,8,["icon"]),n[0]||(n[0]=U("div",{class:"text-h6 mt-2"},"Drag & Drop files here or click to upload",-1)),n[1]||(n[1]=U("div",{class:"text-caption grey--text mt-1"},"Supported: .pdf, .doc, .docx, .txt",-1))]),_:1},8,["class"]),e(M,{ref_key:"fileInput",ref:d,multiple:"",accept:".pdf,.doc,.docx,.txt,.md",class:"d-none",onChange:D},null,512)],64))}},re=ae(se,[["__scopeId","data-v-5b783213"]]),ne=S({__name:"TrainingFiles",setup(b){const{deleteTrainingData:g,fetchTrainingFile:_}=m(),{trainings:u,uploadProgress:l}=z(m()),{formatFileSize:d,getFileIcon:v}=le(),D=i=>{switch(i){case"PENDING":return"warning";case"ERROR":return"error";case"TRAINED":return"success";default:return"default"}},y=i=>i.charAt(0).toUpperCase()+i.slice(1).toLowerCase(),r=f(null),p=f(!1),t=i=>{r.value=i,p.value=!0};N(_);const n=async()=>{r.value&&(console.log(`Deleting training ID: ${r.value.id}`),g(r.value.id),r.value=null,p.value=!1)};return(i,C)=>{var I;return c(),w(T,null,[s(u).length?(c(),V(h,{key:0,title:"Files",class:"pa-0"},{default:a(()=>[s(l)>0&&s(l)<100?(c(),V(j,{key:0,modelValue:s(l),"onUpdate:modelValue":C[0]||(C[0]=o=>q(l)?l.value=o:null),color:"primary"},null,8,["modelValue"])):F("",!0),e(G,null,{default:a(()=>[(c(!0),w(T,null,K(s(u),o=>(c(),V(W,{key:o.id,title:o.url,subtitle:s(d)(o.size),divider:""},{prepend:a(()=>[e(X,{src:s(v)(o.url),width:"24",height:"46",class:"mx-3"},null,8,["src"])]),append:a(()=>[o.progress?(c(),V(H,{key:0,width:2,size:20,color:"primary",class:"mr-2",indeterminate:""})):F("",!0),e(J,{color:D(o.status),size:"small",class:"mr-2"},{default:a(()=>[A(Q(y(o.status)),1)]),_:2},1032,["color"]),e(R,{icon:s(ee),size:"small",color:"error",class:"ml-2",variant:"tonal",onClick:ie=>t(o)},null,8,["icon","onClick"])]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),_:1})):F("",!0),e(te,{show:p.value,"onUpdate:show":C[1]||(C[1]=o=>p.value=o),title:"Warning!",message:`Are you sure you want to delete 
'${(I=r.value)==null?void 0:I.url}' data?`,onConfirm:n},null,8,["show","message"])],64)}}}),ye=S({__name:"TrainingFilePage",setup(b){const{fileChanges:g}=m(),{trainAgent:_,loading:u}=z(m()),{fetchTrainingFile:l}=m(),{connect:d,disconnect:v}=m(),D=f([{title:"Training Data",disabled:!1,href:"#"}]);return N(async()=>{console.log("On Mounted"),await l(),d()}),Y(()=>{console.log("On Unmounted"),v()}),(y,r)=>(c(),w("div",null,[e(B,{title:"Training Data",breadcrumbs:D.value},null,8,["breadcrumbs"]),e($,null,{default:a(()=>[e(k,{cols:"12",md:"7"},{default:a(()=>[e($,null,{default:a(()=>[e(k,{cols:"12",md:"12"},{default:a(()=>[e(h,{title:"Upload Files"},{default:a(()=>[e(re,{onUpload:s(g)},null,8,["onUpload"])]),_:1})]),_:1}),e(k,{cols:"12",md:"12"},{default:a(()=>[e(ne)]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",md:"5"},{default:a(()=>[e(h,{title:"Sources"},{default:a(()=>[e(oe,null,{default:a(()=>[e(R,{loading:s(u),color:"primary",class:"mt-4",block:"",variant:"flat",onClick:s(_)},{default:a(()=>r[0]||(r[0]=[A("Training Agent")])),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]))}});export{ye as default};
